(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{77:function(n,e,t){n.exports=t(99)},82:function(n,e,t){},99:function(n,e,t){"use strict";t.r(e);var r={};t.r(r),t.d(r,"nil",function(){return d}),t.d(r,"cons",function(){return m}),t.d(r,"pop",function(){return v}),t.d(r,"equals",function(){return b}),t.d(r,"getLast",function(){return g}),t.d(r,"toArray",function(){return O}),t.d(r,"toString",function(){return j});var u={};t.r(u),t.d(u,"tr",function(){return z}),t.d(u,"text",function(){return _}),t.d(u,"button",function(){return G}),t.d(u,"container",function(){return H}),t.d(u,"input",function(){return K}),t.d(u,"number",function(){return Q}),t.d(u,"string",function(){return V});var o=t(1),i=t.n(o),c=t(31),a=t.n(c);t(82),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=t(8),f=t(25),p=t(73),l=t(2),d={type:"nil",length:0},m=function(n,e){return{type:"cons",value:n,prev:e,length:e.length+1}},v=function(n){return"nil"===n.type?n:n.prev};function b(n,e){for(var t=n,r=e;;)switch(t.type){case"nil":return"nil"===r.type;case"cons":if("cons"!==r.type||t.value!==r.value)return!1;t=t.prev,r=r.prev;break;default:throw Error("WTF!")}}var g=function(n){return"nil"===n.type?l.none:l.some(n.value)},O=function(n){for(var e=n.length,t=new Array(e),r=n,u=1;"nil"!==r.type;)t[e-u]=r.value,u++,r=r.prev;return t},j=function(n){return O(n).map(function(n){return""+n}).join("/")},h={currentId:d,label:l.none,enabled:!0},y={activeId:l.none,pressedId:l.none,focusedId:l.none,inputBuffer:l.none,activeIdWasPressedBefore:!1},I=function(n){return n.enabled},E=function(n){return function(e){return Object(s.a)({},e,{enabled:n})}};function k(n){return function(e){return Object(s.a)({},e,{activeId:n,inputBuffer:B.equals(n,e.activeId)?e.inputBuffer:l.none,activeIdWasPressedBefore:!!B.equals(n,e.activeId)&&e.activeIdWasPressedBefore})}}function w(n){return function(e){return Object(s.a)({},e,{pressedId:n})}}function x(n){return function(e){return Object(s.a)({},e,{focusedId:n})}}function A(n){return function(e){return Object(s.a)({},e,{inputBuffer:n})}}var B=l.getEq(r);function S(n,e){return B.equals(l.some(n),e.activeId)}function N(n,e){return S(n.currentId,e)}function q(n,e){return B.equals(l.some(n.currentId),e.focusedId)}function F(n,e){return l.isNone(e.activeId)&&!N(n,e)}var L=function(n,e){return{type:"text",id:n,text:e}},P=function(n,e){return{type:"button",id:n,text:e}},T=function(n,e,t){return{type:"input",id:n,value:e,enabled:t}},W=t(3),C=t(4),D=t(50),M=t(49),$=function(n){return{type:"continue",state:n}},R=function(n){return{type:"suspendAndResume",effect:n}},J={equals:function(n,e){return b(n.ui.id,e.ui.id)},compare:function(n,e){return 0}},U=function(n){return function(n){return{type:"halt"}}},z=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return{type:"translable_string",strings:n,values:t}},_=function(n){return C.gets(function(e){return{ui:L(e.currentId,n),tick:U}})},G=function(n,e){return C.gets(function(t){return{ui:P(t.currentId,n),tick:function(n){return function(n){var r=F(t,n),u=function(n,e){return B.equals(l.some(n.currentId),e.pressedId)}(t,n),o=q(t,n),i=n.activeIdWasPressedBefore,c=N(t,n);return u&&!o?(console.log("button: focusing"),$(Object(W.pipe)(n,x(l.some(t.currentId))))):r&&o&&u?(console.log("button: activating"),$(Object(W.pipe)(n,k(l.some(t.currentId))))):c&&!i?(console.log("button: onPress"),R(Object(W.pipe)(e(),M.map(function(e){return Object(W.pipe)(n,(t=!0,function(n){return Object(s.a)({},n,{activeIdWasPressedBefore:t})}));var t})))):c&&!u?(console.log("button: deactivating"),$(Object(W.pipe)(n,k(l.none)))):{type:"halt"}}}}})},H=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return Object(W.pipe)(D.array.sequence(C.state)(e),C.map(D.sort(J)),C.chain(function(n){return C.gets(function(e){return{ui:(t=e.currentId,r=n.map(function(n){return n.ui}),{type:"container",id:t,children:r}),tick:function(e){return function(e){return(t=n.map(function(n){return n.tick(n.ui)}),function(n){for(var e=n,r=0;t.length>r;){var u=t[r](e);switch(u.type){case"halt":break;case"continue":e=u.state;break;case"suspendAndResume":return u;default:throw Error("WTF!")}r++}return e!==n?$(e):{type:"halt"}})(e);var t}}};var t,r})}))},K=function(n,e,t,r){return C.gets(function(u){return{ui:T(u.currentId,n,I(u)),tick:function(o){return function(o){var i=F(u,o),c=N(u,o),a=q(u,o),s=function(n,e){return N(n,e)}(u,o),f=I(u);if(c&&!f)return $(Object(W.pipe)(o,k(l.some(u.currentId))));if(f){if(!c&&a&&i)return $(Object(W.pipe)(o,k(l.some(u.currentId))));if(c&&!a&&s){if(l.isNone(o.inputBuffer)&&t)return $(Object(W.pipe)(o,k(l.none)));var p=l.getOrElse(function(){return n})(o.inputBuffer);if(r(p))return console.log("input: run onChange"),R(Object(W.pipe)(e(p),M.map(function(){return A(l.none)(o)})))}}return{type:"halt"}}}}})},Q=function(n,e,t){return K(n.toFixed(0),function(n){return e(parseInt(n))},t,function(n){return!isNaN(parseInt(n))})},V=function(n,e,t){return K(n,e,t,function(n){return!0})},X=function(n){return function(e){return Object(W.pipe)(C.modify((t=n,function(n){return Object(s.a)({},n,{currentId:m(t,n.currentId)})})),C.chain(function(){return e}),C.chainFirst(function(){return C.modify(function(n){return Object(s.a)({},n,{currentId:v(n.currentId)})})}));var t}},Y=function(n){return function(e){return Object(W.pipe)(C.gets(I),C.chain(function(t){return Object(W.pipe)(C.modify(E(n)),C.chain(function(){return e}),C.chainFirst(function(){return C.modify(E(t))}))}))}},Z=t(54),nn=t(55),en=t(75),tn=t(56),rn=t(76),un=t(74),on=t(106),cn=t(110),an=t(71),sn=t(107),fn=t(108),pn=t(109),ln=o.createContext(fn.a(y));function dn(n){switch(n.dsl.type){case"input":return o.createElement(bn,Object.assign({},n,{key:j(n.dsl.id)}));case"container":return o.createElement(jn,Object.assign({},n,{key:j(n.dsl.id)}));case"text":return o.createElement(gn,Object.assign({},n,{key:j(n.dsl.id)}));case"button":return o.createElement(On,Object.assign({},n,{key:j(n.dsl.id)}))}return o.createElement(o.Fragment,null,JSON.stringify(n.dsl))}function mn(n){return n.strings.map(function(e,t){return e+(n.values[t]||"")}).join("")}function vn(n,e){var t=o.useState(e),r=Object(un.a)(t,2),u=r[0],i=r[1];return o.useLayoutEffect(function(){var e=n.subscribe(i);return function(){return e.unsubscribe()}},[n]),u}var bn=o.memo(function(n){var e=o.useContext(ln),t=n.dispatch,r=n.update,u=n.dsl.id,i=n.dsl.value||"",c=j(u),a=o.useMemo(function(){return function(n){return r(A(l.some(n)))()}},[r]),s=o.useMemo(function(){return t(x(l.some(u)))},[t,c]),f=o.useMemo(function(){return t(x(l.none))},[t,c]),p=o.useRef(),d=o.useMemo(function(){return e.pipe(on.a(function(n){return S(u,n)}))},[e,c]),m=o.useMemo(function(){return e.pipe(on.a(function(n){return function(n,e){return B.equals(l.some(n),e.focusedId)}(u,n)}))},[e,c]),v=o.useMemo(function(){return e.pipe(on.a(function(n){return S(u,n)?l.getOrElse(function(){return i})(n.inputBuffer):i}))},[e,c,i]),b=vn(d,!1),g=vn(m,!1),O=vn(v,i);return o.useLayoutEffect(function(){g&&p.current&&!p.current.isFocused()&&(p.current.focus(),console.log("forced focus to",c))}),"input"!==n.dsl.type?null:o.createElement(cn.a,{ref:p,editable:b,value:O,onChangeText:b?a:void 0,onFocus:g?void 0:s,onBlur:g?f:void 0,autoCapitalize:"none"})});bn.displayName="DSL(Input)";var gn=o.memo(function(n){return"text"!==n.dsl.type?null:o.createElement(an.a,null,mn(n.dsl.text))});gn.displayName="DSL(Text)";var On=o.memo(function(n){return"button"!==n.dsl.type?null:o.createElement(sn.a,{onPress:function(){n.dispatch(w(l.some(n.dsl.id)))(),n.dispatch(w(l.none))()},title:mn(n.dsl.text)})});On.displayName="DSL(Button)";var jn=o.memo(function(n){return"container"!==n.dsl.type?null:o.createElement(o.Fragment,{key:j(n.dsl.id)},n.dsl.children.map(function(e,t){return dn(Object(s.a)({},n,{dsl:e}))}))});jn.displayName="DSL(Container)";var hn=o.memo(function(n){return dn(n)}),yn=function(n){function e(n){var t;return Object(Z.a)(this,e),(t=Object(en.a)(this,Object(tn.a)(e).call(this,n))).state=y,t.state$=new pn.a(t.state),t.app=void 0,t.eventLoop=function(n){for(var e=n,r=!0,u=0,o=[];r;){var i=t.app.tick(t.app.ui)(e);switch(i.type){case"halt":r=!1;break;case"continue":e=i.state,o.push(e);break;case"suspendAndResume":e=i.effect(),o.push(e),t.app=t.getApp(t.props)}++u>10&&(r=!1,console.log(o),console.warn("end of max loop count"))}return e},t.dispatch=function(n){return function(){return t.setState(function(e){var r=t.eventLoop(n(e));return t.state$.next(r),r})}},t.update=function(n){return function(){return t.setState(function(e){var r=n(e);return t.state$.next(r),r})}},t.app=t.getApp(n),t}return Object(rn.a)(e,n),Object(nn.a)(e,[{key:"getApp",value:function(n){return n.getApp()(h)[0]}},{key:"componentWillMount",value:function(){var n=this;this.setState(function(e){return n.eventLoop(e)})}},{key:"render",value:function(){return o.createElement(ln.Provider,{value:this.state$},o.createElement(hn,{dsl:this.app.ui,dispatch:this.dispatch,update:this.update}))}}]),e}(o.Component);function In(){var n=Object(f.a)(["Nome:"]);return In=function(){return n},n}function En(){var n=Object(f.a)(["Salva"]);return En=function(){return n},n}function kn(){var n=Object(f.a)(["Ciao "," ",", complimenti per i tuoi "," anni!"]);return kn=function(){return n},n}function wn(){var n=Object(f.a)(["Cognome:"]);return wn=function(){return n},n}function xn(){var n=Object(f.a)(["Nome:"]);return xn=function(){return n},n}function An(){var n=Object(f.a)(["Et\xe0:"]);return An=function(){return n},n}var Bn={name:"",surname:"",age:0};a.a.render(i.a.createElement(function(){return o.createElement(yn,{getApp:function(){return function(n){for(var e=[],t=0;t<1e3;t++)e.push(""+t);return function(t){return H.apply(u,[Object(W.pipe)(H(_(z(An())),Object(W.pipe)(Q(n.age,function(e){return t(Object(s.a)({},n,{age:e}))},!0),X("age"))),X("eta")),Object(W.pipe)(H(_(z(xn())),Object(W.pipe)(V(n.name,function(e){return t(Object(s.a)({},n,{name:e}))},!0),X("name"),Y(n.age<=18))),X("name")),Object(W.pipe)(H(_(z(wn())),Object(W.pipe)(V(n.surname,function(e){return t(Object(s.a)({},n,{surname:e}))},!0),X("surname"))),X("surname")),Object(W.pipe)(_(z(kn(),n.name,n.surname,n.age.toFixed(0))),X("sum")),Object(W.pipe)(G(z(En()),function(){return function(){return console.log(n)}}),X("button"))].concat(Object(p.a)(e.map(function(e,r){return Object(W.pipe)(H(Object(W.pipe)(_(z(In())),X("lol")),Object(W.pipe)(V(n.name,function(e){return t(Object(s.a)({},n,{name:e}))},!0),X("name"+r))),X("div"+r))}))))}}(Bn)(function(n){return console.log("STATE UPDATE",n),function(){console.log("STATE UPDATED",n),Bn=n}})}})},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(n){n.unregister()})}},[[77,1,2]]]);
//# sourceMappingURL=main.a79ad35d.chunk.js.map